<!DOCTYPE HTML>
<html lang="en">
<head>
	<title>Firefox is your Marionette</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=792, user-scalable=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<link rel="stylesheet" href="shower/themes/mozilla/styles/style.css">
</head>
<body class="list">
	<header class="caption">
        <h1>Firefox is your Marionette</h1>
		<p>Get fun using the Firefox unit test system</p>
	</header>
	<section class="slide cover"><div>
        <h2>Firefox is your Marionette</h2>
		<p><a href="https://daniele.tech">Daniele Scasciafratte</a></p>
		<img src="pictures/picture.jpg" alt="">
	</div></section>
	<section class="slide"><div>
		<h2>Daniele</h2>
		<ul style="float: left;">
			<li>Co Founder/CTO Codeat</li>
			<li>Open Source Addicted</li>
			<li>Mozillian & Mozilla Reps<br> & Mozilla TechSpeaker</li>
			<li>WordPress Core Contributor/Developer</li>	
			<li>ClassicPress Founding Committee</li>						
			<li>WordPress Rome/Terni meetup</li>
			<li>Project Translation Editor<br> in WordPress Italia</li>
			<li>Industria Italiana Software Libero<br> Vice Presidente</li>
		</ul>
		<img src="pictures/film.jpg" style="float: right;" />
	</div></section>
	<section class="slide cover"><div>
		<img src="pictures/automate-job.png" />
	</div></section>
	<section class="slide lightblue"><div>
		<h2>My personal rules of automation</h2>
		<ul>
			<li class="next">If you do a manual process more then 3 times</li>
			<li class="next"> - That is always the same</li>
			<li class="next">On the computer</li>
			<li class="next"> - That you can replicate with scripting</li>
			<li class="next"> - And that you want to relax more</li>
			<li class="next"><h3 style="display: inline;font-size: 34px;text-decoration: underline;">That is boring</h3></li>
			<li class="next"><h2 style="display: inline;font-size: 38px;text-decoration: underline;">That a missing step can create issues</h2></li>
			<li class="next"><h1 style="display: inline;font-size: 50px;text-decoration: underline;">It is time to do a script!</h1></li>
		</ul>
	</div></section>
	<section class="slide cover"><div>
		<img src="pictures/scriptingtime.png" />
	</div></section>
	<section class="slide blue"><div>
		<h1>Browsers and scripting</h1><br>
		<ol>
			<li class="next"><h2 style="display: inline;">WebExtensions</h2></li>
			<li class="next"><h2 style="display: inline;">Scripting with CLI commands</h2></li>
			<li class="next"><h2 style="display: inline;">Unit Test/DevTools protocol</h2></li>
		</ol>
		<p class="note next" style="color:#fff;">What do you think that is most fun and powerful?</p>
	</div></section>
	<section class="slide blue"><div>
		<h2>WebExtensions</h2>
		<img src="pictures/webext.jpg" style="float: left;" />
		<ol style="float: left;margin-left: 40px;">
			<li class="next">Cross Browser compatibility</li>
			<li class="next">API stable between various releases</li>
			<li class="next">More API only on Firefox</li>
			<li class="next">Huge marketplace</li>
			<li class="next">Useful for specific kind of tasks</li>
			<li>Previous Fosdem's Talk: <a href="https://archive.fosdem.org/2017/schedule/event/mozilla_firefox_and_webextensions/">2017</a>, <a href="https://archive.fosdem.org/2018/schedule/event/mozilla_webextensions_api_status_fx57/">2018</a></li>
		</ol>
		<div style="clear:both"></div>
		<h2>Shell scripting</h2>
		<ol style="float: left;">
			<li class="next">Missing Cross Browser compatibility</li>
			<li class="next">Only specific features available like screenshot</li>
			<li class="next">Very highly skilled users</li>
			<li class="next">Useful for specific kind of tasks</li>
			<li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Command_Line_Options">Command Line Options</a></li>
		</ol>
		<img src="pictures/shell.png" style="float: right;margin-top: -40px;" />
	</div></section>
	<section class="slide lightblue"><div>
		<h2>Unit Test/DevTools protocol</h2>
		<ul>
			<li class="next">Puppeteer for Chrom*, NodeJS</li>
			<li class="next">Selenium, Java with bindings for other languages
				<ul>
					<li class="next">Firefox 55 maximum supported</li>
				</ul>
			</li>
			<li class="next">Selenium IDE as Firefox/Chrome extension</li>
			<li class="next">Puppeteer for Firefox, NodeJS (experimental)</li>
			<li class="next">Marionette for Firefox (and Firefox for Android), Python</li>
		</ul>
	</div></section>
	<section class="slide cover"><div>
		<img src="pictures/pinocchio.png" />
	</div></section>
	<section class="slide red"><div>
		<h2>The Marionette in IT world</h2>
		<blockquote>Marionette is the remote protocol that lets out-of-process programs communicate with, instrument, and control Gecko-based browsers.<br><br>
It provides interfaces for interacting with both the internal JavaScript runtime and UI elements of Gecko-based browsers, such as Firefox and Fennec. It can control both the chrome- and content documents, giving a high level of control and ability to replicate, or emulate, user interaction.</blockquote><br>
		<p class="note" style="color:#fff;"><a href="https://firefox-source-docs.mozilla.org/testing/marionette/marionette/">https://firefox-source-docs.mozilla.org/testing/marionette/marionette/</a></p>
	</div></section>
	<section class="slide shout gradient-nightly"><div>
		<h2>How to use it?</h2>
	</div></section>
	<section class="slide red"><div>
		<h2>Enable Marionette</h2>
		<ol>
			<li class="next">Download Firefox for Developer build</li>
			<li class="next"><code>pip install marionette_driver</code></li>
			<li class="next">Change settings in about:config:<br>
				<code>marionette.enabled -> true</code><br>
				<code>marionette.port -> 2828</code>
			</li>
			<li class="next">Verify to have the latest version of marionette</li>
			<li class="next">(Optional) Execute Firefox in Marionette mode <code>./firefox -marionette</code></li>
		</ol>
	</div></section>
	<section class="slide"><div>
		<h2>How works</h2>
		<p>Marionette is a bridge that use sockets internally to communicate with Firefox and require a specific Firefox build.<br><br>
		Offers a full control of Firefox also of other stuff that are not included in DevTools protocol because it is used in Firefox for testing.<br><br>
		Also it is the same technology used on the various Firefox version like Firefox for Android.<br><br>
		Marionette is an implementation of the WebDriver standard but wrapped in this "framework" that is stable, require only a supported Firefox version.
		</p>
	</div></section>	
	<section class="slide red"><div>
		<h2>My story</h2>
		<p>As Mozillian (and many other in this room) we prefer to use Mozilla technologies like Firefox DevTools.<br>
		I try to do the same also on my daily job in my (little) company.<br><br>
		<b>How many of you evangelism about Mozilla technologies during your daily tasks?</b><br>
		<p>Let's see different tools that I did for my job but also to help other OpenSource communities with Marionette.</p>
	</div></section>
	<section class="slide orange"><div>
		<img src="pictures/bulkrejectwp.png" style="margin-left: -55px;margin-top:-40px" />
		<p class="note" style="color:#fff;"><a href="https://github.com/Mte90/BulkRejectGP">https://github.com/Mte90/BulkRejectGP</a></p>
	</div></section>
	<section class="slide orange"><div>
		<img src="pictures/wp-ff-exp-imp.png" style="margin-left: -10px;margin-top:-40px" />
		<p class="note" style="color:#fff;"><a href="https://github.com/CodeAtCode/wp-ff-exp-imp">https://github.com/CodeAtCode/wp-ff-exp-imp</a></p>
	</div></section>
	<section class="slide shout gradient-nightly"><div>
		<h2>Demo time</h2>
	</div></section>
	<section class="slide cover"><div>
		<video controls style="z-index:99999">
            <source src="wpff.webm" type="video/webm">
        </video>
	</div></section>
	<section class="slide"><div>
		<h2>How works quickly</h2>
		<pre>
			<code>from marionette_driver.marionette import Marionette</code>
			<code>from marionette_driver import By, Actions</code>
			<code># Connect to Firefox</code>
			<code>client = Marionette(host='localhost', port=<mark class="important">2828</mark>)</code>
			<code><mark class="important">client.start_session()</mark></code>
			<code>[...]</code>
			<code>posts = client.find_elements(<mark class="important">By.CSS_SELECTOR</mark>, 'td.title a.row-title')</code>
			<code>for post in posts:</code>
			<code>Actions(client).<mark class="important">middle_click</mark>(post).perform()</code>
			<code>[...]</code>
			<code>client.switch_to_window(client.window_handles[-1])</code>
			<code>[...]</code>
			<code>export.write(<mark class="important">client.page_source</mark>.encode('utf-8'))</code>
		</pre>
		<p class="note">You can also inject JavaScript, switch between tabs to change the focus, autofill username/password etc.</p>
	</div></section>
	<section class="slide orange"><div>
		<h2>Another future example project</h2>
		<ol>
			<li class="next">We need to export 170000~ url from Google Analytics</li>
			<li class="next">The web interface support only 5000 for page</li>
			<li class="next">The API require a license</li>
			<li class="next">Our idea to let reuse that script</li>
			<li class="next">Using Firefox to auto click the Download button</li>
			<li class="next">That automatically switch to the next page with other 5000 urls</li>
			<li class="next">Later with other script we will compare that list</li>
			<li class="next">And remove the pages that are not in the list from our customer that are 15000~</li>
		</ol>
	</div></section>
	<section class="slide blue"><div>
		<h2>My usual dev workflow</h2>
		<ol>
			<li>Analyze the page, if
				<ul>
					<li>I need to parse in realtime because of other steps</li>
					<li>I can do the parse later of what I am looking for</li>
				</ul>
			</li>
			<li>Analyze the flow, If
				<ul>
					<li>the tool require different parameters, add a config file</li>
					<li>I can open manually the url to script</li>
				</ul>
			</li>
			<li>If will be used by others, avoid hardcoded stuff</li>
			<li>Write in the readme always the settings to change in Firefox</li>
			<li>Evaluate if I need the <code>headless</code> mode</li>
		</ol>
	</div></section>
	<section class="slide blue"><div>
		<h2>Resources</h2>
		<ol>
			<li>Marionette, Act <a href="http://vakila.github.io/blog/marionette-act-i-automation/">1</a>-<a href="http://vakila.github.io/blog/marionette-act-ii-testing/">2</a> by Anjana Sofia Vakil</li>
			<li><a href="https://firefox-source-docs.mozilla.org/testing/marionette/marionette/">https://firefox-source-docs.mozilla.org/testing/marionette/marionette/</a></li>
			<li><a href="https://marionette-client.readthedocs.io/en/master/">https://marionette-client.readthedocs.io/en/master/</a></li>
		</ol>
	</div></section>
	<section class="slide"><div>
        <h2>Question?</h2>
        <figure class="frame place swing">
            <img src="pictures/redpanda.jpg" alt="Red panda (Firefox)">
        </figure>
        <p style="margin-top:440px">
            Daniele Scasciafratte - <a href="http://twitter.com/Mte90Net">@Mte90Net</a><br>
            <strong>Slides</strong>: <a href="https://mte90.tech/Talk-Marionette/">https://mte90.tech/Talk-Marionette/</a>
        </p>
    </div></section>
    
	<div class="progress"><div></div></div>
	<script src="shower/scripts.js"></script>
</body>
</html>
