<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Amber Lang - Easily write Bash with a transpiler</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/codeat.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/github.css">
	</head>

	<body>
		<div class="barra"><div class="titolo"></div><div class="logo"></div></div>
		<div class="barra bottom"><div class="titolo">Daniele Scasciafratte</div><div class="hashtag"></div></div>
		<div class="reveal">

			<div class="slides">
				<section>
					<h1>Amber Lang</h1>
					<h3>Easily write Bash with a transpiler</h3>
					<p>
						<small><a href="http://mte90.net">Daniele Scasciafratte</a> / <a href="http://twitter.com/mte90net">@Mte90Net</a></small>
					</p>
				</section>

				<section data-transition="slide" data-background="pictures/hello.gif">
					<div class="background">
						<h2 class="white-black-shadow">Daniele Scasciafratte</h2>
						<ul class="white-black-shadow">
							<li>Co Founder/CTO Codeat</li>
							<li>Open Source Addicted</li>
							<li>Mozillian & Mozilla TechSpeaker/Reps (former)</li>
							<li>WordPress Core Contributor (former)</li>
							<li>Podcast üáÆüáπ Daniele.tech - Opinioni in open source</li>
							<li>Italian Linux Society council member</li>
							<li>Amber Lang Co-Maintainer</li>
							<li>Book Author: <i>"Contribute to Open Source: the right way"</i></li>
						</ul>
					</div>
				</section>

				<section>
					<h2>Bash</h2>
					<blockquote>Bash, short for Bourne-Again SHell, is a shell program and command language supported by the Free Software Foundation and first developed for the GNU Project by Brian Fox. Designed as a 100% free software alternative for the Bourne shell, it was initially released in 1989.</blockquote>
						<small><a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">https://en.wikipedia.org/wiki/Bash_(Unix_shell)</a></small>
				</section>

				<section>
					<h2>Bash</h2>
					<blockquote>Since then, Bash has become by far the most popular shell among users of Linux, becoming the default interactive shell on that operating system's various distributions and on Apple's macOS releases before Catalina in October 2019. Bash has also been ported to Microsoft Windows and distributed with Cygwin and MinGW, to DOS by the DJGPP project and to Android via various terminal emulation applications.</blockquote>
						<small><a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">https://en.wikipedia.org/wiki/Bash_(Unix_shell)</a></small>
				</section>

				<section>
					<h2>Bash Pro/Cons</h2>
					<p>‚úîÔ∏è It is everywhere</p>
					<p class="fragment">‚úîÔ∏è Already installed (except for the commands)</p>
					<p class="fragment roll-in">‚úîÔ∏è Standard for Linux scripts</p>
					<p class="fragment">‚ùå Unique (and strange) syntax</p>
					<p class="fragment">‚ùå It is easy to follow wrong practices</p>
					<p class="fragment roll-in">‚úîÔ∏è/‚ùå Linux commands knowledge required</p>
					<p class="fragment">‚ùå Time consuming to write a (complex) script</p>
				</section>

				<section>
					<h1 style="margin: 0;">Amber Lang</h1>
					<img src="https://amber-lang.com/amber-logo.svg" style="max-height: 500px;"/><br>
					<a href="https://amber-lang.com">https://amber-lang.com/</a>
				</section>

				<section>
					<div style="float: left;width: 50%;">
					<h3>Bash</h3>
					<pre><code class="bash" style="max-height:100%" data-trim>
example() {
  local value=$1
  if [ 1 -gt 0 ]; then
    __array_0=(${value} ${value})
    local numbers=("${__array_0[@]}")
    local sum=0
    for i in "${numbers[@]}"; do
      sum=$(${sum} + ${numbers[${i}]})
    done
    echo "it's ""me"
    returnvalue=${sum}
    return 0
  fi
  return 1
}
example 1
if [ $? != 0 ]; then
    echo "What???"
else
    echo $returnvalue
fi
					</code></pre>
					</div>
					<div style="float: right;width: 50%;">
					<h3>Amber</h3>
					<pre><code class="amber" data-trim>
fun example(value:Num = 1) {
    if 1 > 0 {
        let numbers = [value, value]
        let sum = 0
        loop i in numbers {
            sum += numbers[i]
        }
        echo "it's " + "me"
        return sum
    }
    fail 1
}
echo example(1) failed {
    echo "What???"
}
					</code></pre>
					</div>
				</section>

				<section>
					<h3>Real Amber Script (example)</h3>
					<pre><code class="amber" style="font-size: 16px;line-height: 18px;max-height:100%" data-trim>
#!/usr/bin/env amber
import { split, contains } from "std/text"
import { * } from "std/fs"
let path = "/tmp/amber-sc-tests"
if (not dir_exist(path)) {
    create_dir(path)
}
let report = "{path}/report.txt"
trust file_write(report, "Report for Shellcheck")
let output = ""
let stdtests = trust $/usr/bin/ls "src/tests/stdlib/"$
let stdlib = split(stdtests, "\n")
loop v in stdlib {
    if (not contains(v, ".txt") and file_exist("src/tests/stdlib/{v}")) {
        echo "Generating Bash script for test {v}"
        trust {
            trust $amber "src/tests/stdlib/{v}" "{path}/{v}.sh"$
            output = trust $shellcheck "{path}/{v}.sh"$
        }
        if (status != 0) {
            echo "Shellcheck found something!"
            trust file_append(report, output)
        }
    }
}
					</code></pre>
				</section>

				<section>
					<h3>Real Amber Script</h3>
					<pre><code class="amber" style="font-size: 16px;line-height: 18px;max-height:100%" data-trim>
import { make_executable } from "std/fs"
import { download } from "std/http"
import { is_root } from "std/env"
import { contains } from "std/text"

if not is_root() {
    echo "This script requires root permissions!"
    exit(1)
}

[..]

fun download_to_bin(download_url, binary, packed_file) {
    if silent download(download_url, packed_file) {
        trust {
            if contains("tar.gz", packed_file) {
                $tar -zxvf "./{packed_file}" -C ./ > /dev/null 2>&1$
                trust mv "./{binary}" "/usr/local/bin"
            } else {
                $gunzip -c - > "/usr/local/bin/{binary}"$
            }
            $rm "./{packed_file}"$
        }
        make_executable("/usr/local/bin/{binary}")
    } else {
        echo "Download for {binary} at {download_url} failed"
        exit(1)
    }
}
					</code></pre>
					<small><a href="https://docs.amber-lang.com/by_example/lsp_installer">https://docs.amber-lang.com/by_example/lsp_installer</a></small>
				</section>

				<section>
					<h2>Features</h2>
					<ul>
						<li>Integrates (if found): shfmt (shell code formatter), bshchk (runtime Bash dependency checker)</li>
						<li>Bash (generated) more readable</li>
						<li>Syntax easier to remember</li>
						<li>Type: Integer, Float, Text, Array, Boolean etc</li>
						<li>Standard Library + Builtins (with internal automated tests)</li>
						<li>ShellCheck code valid (in progress)</li>
						<li>Written in Rust (with standard library in pure Amber)</li>
						<li>Editor support for VS Code, Zed and Vim (initial)</li>
					</ul>
				</section>

				<section>
					<h2>Next version (already in dev)</h2>
					<ul>
						<li>Bugfixes</li>
						<li><code>unsafe</code> keyword to <code>trust</code></li>
						<li>Windows support</li>
						<li>Glob function</li>
						<li>New functions in standard library and builtins</li>
					</ul>
				</section>

				<section>
					<h2>Roadmap</h2>
					<ul>
						<li>More standard library & Builtins</li>
						<li>More readable and optimized Bash code</li>
						<li>Improve the syntax for more features</li>
						<li>ShellCheck code valid (in progress)</li>
						<li>OOP support?</li>
						<li>Define the Bash version to support in the generated code</li>
						<li>LSP server (WIP)</li>
					</ul>
				</section>

				<section style="text-align: left;">
					<h1>THE END</h1>
					<p>
						- <a href="https://docs.amber-lang.com">docs.amber-lang.com</a><br>
					</p>
				</section>

			</div>
		</div>

		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			function amber(hljs) {
				const interpolation = {
					className: 'interp',
					begin: /\{/,
					end: /}/,
					contains: []
				}
				const string = {
					scope: 'string',
					begin: '"',
					end: '"',
					contains: [
						hljs.BACKSLASH_ESCAPE,
						interpolation
					]
				}
				const command = {
					scope: 'command',
					begin: /\$/,
					end: /\$/,
					contains: [
						hljs.BACKSLASH_ESCAPE,
						interpolation
					]
				}
				const operator = {
					scope: 'operator',
					match: /[-+*/%<>=!&|?]/
				}
				const keywords = {
					scope: 'keyword',
					match: /\b(ref|to|error|status|if|echo|loop|in|silent|return|fun|else|break|continue|and|or|not|let|sh|main|failed|fail|trust|then|pub|import|from|as|nameof|is)\b/
				}
				const type = {
					scope: 'type',
					match: /[A-Z][a-zA-Z0-9_]+/
				}
				const fun = {
					scope: 'function',
					match: /\b([a-zA-Z0-9_]+)\b(?=\()/
				}
				const variable = {
					scope: 'variable',
					match: /[a-zA-Z0-9_]+/
				}
				const range = {
					scope: 'number',
					match: /\.?\.\=?/
				}
				const constant = {
					scope: 'number',
					match: /\b(false|true|null)\b/
				}
				const compilerFlag = {
					scope: 'comment',
					match: /\#\[.*\]/
				}
				const all = [
					hljs.C_LINE_COMMENT_MODE,
					hljs.C_BLOCK_COMMENT_MODE,
					hljs.C_BLOCK_COMMENT_MODE,
					hljs.C_NUMBER_MODE,
					string,
					range,
					command,
					operator,
					constant,
					keywords,
					compilerFlag,
					type,
					fun,
					variable
				]
				interpolation.contains = all.concat([{
					begin: /\{/,
					end: /\}/,
					contains: [
						'self'
					].concat(all)
				}]);
				return ({
					case_insensitive: false,
					contains: all
				});
			}
			Reveal.initialize({
				controls: false,
				progress: true,
				history: true,
				center: true,
				touch: true,
				overview: false,
				transition: 'zoom',
				highlight: {
					beforeHighlight: (hljs) => hljs.registerLanguage("amber", amber)
				},
				plugins: [RevealMarkdown, RevealHighlight]
			});

			document.querySelector('.titolo').textContent = document.title;
		</script>
	</body>
</html>
